<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ancient Science - BharatRoots</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="AncientScience.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;800&family=Outfit:wght@300;400;600&family=Tiro+Sanskrit&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">


</head>

<body>

    <section class="hero">
        <h1>Ancient <span>Science</span> & Technology</h1>
        <p>Decoding the blueprint of Bharatiya innovation. Where observation, logic, and intuition created the
            foundations of modern knowledge.</p>
    </section>

    <div class="domain-header" id="math">
        <h2 class="domain-title"><i class="fa-solid fa-calculator"></i> Mathematical Sciences</h2>
        <div class="domain-line"></div>
    </div>

    <div class="domain-grid" id="math-grid"></div>

    <div class="domain-header" id="astro">
        <h2 class="domain-title"><i class="fa-solid fa-star"></i> Astronomy & Cosmology</h2>
        <div class="domain-line"></div>
    </div>

    <div class="domain-grid" id="astro-grid"></div>

    <section class="spotlight-section">
        <div class="spotlight-content">
            <div class="spotlight-text">
                <h2>Engineering Spotlight: <br> The <span>Rustless</span> Wonder</h2>
                <p>The Iron Pillar of Delhi, standing since the Gupta period (approx 400 CE), continues to baffle modern
                    scientists. Despite being exposed to the elements for 1600 years, it shows negligible rust.</p>
                <p>This demonstrates an advanced knowledge of metallurgy, specifically the process of phosphorus-rich
                    iron forging that creates a protective passive film.</p>
                <div class="evidence-tag" style="background: rgba(255, 215, 0, 0.1); color: var(--gold); width:auto;">
                    <i class="fa-solid fa-flask"></i> Advanced Chemical Engineering
                </div>
            </div>
            <div class="spotlight-visual">
                <i class="fa-solid fa-gavel pillar-icon" style="transform: rotate(-90deg);"></i>
            </div>
        </div>
    </section>

    <div class="domain-header" id="medicine">
        <h2 class="domain-title"><i class="fa-solid fa-heart-pulse"></i> Medical & Life Sciences</h2>
        <div class="domain-line"></div>
    </div>

    <div class="domain-grid" id="med-grid"></div>


    <section class="sources-section">
        <h2 class="domain-title" style="justify-content: center;">Primary Source Hub</h2>
        <p style="color: var(--text-grey); margin-top: 10px;">Ancient texts where these scientific principles are
            documented.</p>
        <div class="sources-grid">
            <a href="#" class="source-btn"><i class="fa-solid fa-scroll"></i> Aryabhatiya</a>
            <a href="#" class="source-btn"><i class="fa-solid fa-book-medical"></i> Sushruta Samhita</a>
            <a href="#" class="source-btn"><i class="fa-solid fa-star-half-stroke"></i> Surya Siddhanta</a>
            <a href="#" class="source-btn"><i class="fa-solid fa-calculator"></i> Lilavati (Bhaskara II)</a>
        </div>
    </section>

    <div id="sci-modal" class="modal-overlay">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            <div class="modal-header">
                <div id="modal-icon" class="sci-icon-box" style="font-size: 2rem; color: #ffd700;"></div>
                <h2 id="modal-title">Title</h2>
            </div>
            <div class="modal-body">
                <p id="modal-desc">Full description will load here...</p>
                <div class="evidence-tag" id="modal-source" style="margin-top: 20px; display: inline-block;">
                    <i class="fa-solid fa-book"></i> Source:
                </div>
            </div>
        </div>
    </div>

    <script>
      const mathContainer = document.getElementById('math-grid');
        const astroContainer = document.getElementById('astro-grid');
        const medContainer = document.getElementById('med-grid');

        const API_URL = "http://localhost:8081/Api/alltopic";
        
        // GLOBAL VARIABLE: Data ko store karne ke liye
        let globalSciData = []; 

        async function loadData() {
            try {
                const Response = await fetch(API_URL);
                const result = await Response.json();
                
                // Data array ko global variable me daal diya
                globalSciData = result.data; 

                // Containers ko clear karein
                mathContainer.innerHTML = '';
                astroContainer.innerHTML = '';
                medContainer.innerHTML = '';

                globalSciData.forEach(item => {
                    let iconHtml = '';

                    // Icon set karne ka logic
                    if (item.isTextIcon === true || item.isTextIcon === "true") {
                        iconHtml = item.iconClass; 
                    } else {
                        iconHtml = `<i class="${item.iconClass}"></i>`;
                    }

                    // FIXED: '${item.id}' mein single quotes lagaye hain kyunki ID alphanumeric string hai
                    const cardHTML = `
                <div class="sci-card">
                    <div class="sci-card-header">
                        <div class="sci-icon-box">${iconHtml}</div>
                        <h3>${item.title}</h3>
                    </div>
                    <div class="sci-card-body">
                        <p>${item.shortDescription}</p>
                        <span class="evidence-tag"><i class="fa-solid fa-book"></i> Source: ${item.sourceScripture}</span>
                        <button class="read-more-btn" onclick="handleReadMore('${item.id}')">Read More</button>
                    </div>
                </div>
            `;

                    // Category ke hisaab se grid mein daalna
                    if (item.category === 'Mathematics') {
                        mathContainer.innerHTML += cardHTML;
                    } else if (item.category === 'Astronomy') {
                        astroContainer.innerHTML += cardHTML;
                    } else if (item.category === 'Medicine') {
                        medContainer.innerHTML += cardHTML;
                    }
                });

            } catch (error) {
                console.error("Error loading data:", error);
                alert("Data not found or API error");
            }
        }
        
        // Page load hote hi data fetch karein
        document.addEventListener('DOMContentLoaded', loadData);

        // ==========================================
        // POPUP (MODAL) LOGIC
        // ==========================================

        function handleReadMore(id) {
            // Click kiye gaye item ka data dhoondho
            const item = globalSciData.find(data => data.id === id);
            
            if (!item) {
                console.error("Item not found");
                return;
            }

            // Icon Set karo popup ke liye
            let iconHtml = '';
            if (item.isTextIcon === true || item.isTextIcon === "true") {
                iconHtml = item.iconClass;
            } else {
                iconHtml = `<i class="${item.iconClass}"></i>`;
            }

            // FIXED: yahan 'fullContent' use kiya hai jo tumhare database format me hai
            const description = item.fullContent ? item.fullContent : item.shortDescription;

            // Popup me data daalo
            document.getElementById('modal-icon').innerHTML = iconHtml;
            document.getElementById('modal-title').innerText = item.title;
            document.getElementById('modal-desc').innerText = description;
            document.getElementById('modal-source').innerHTML = `<i class="fa-solid fa-book"></i> Source: ${item.sourceScripture}`;

            // Popup ko screen par dikhao
            document.getElementById('sci-modal').classList.add('active');
        }

        // Popup close karne ka function
        function closeModal() {
            document.getElementById('sci-modal').classList.remove('active');
        }

        // Agar user popup ke bahar click kare toh bhi band ho jaye
        window.onclick = function(event) {
            const modal = document.getElementById('sci-modal');
            if (event.target === modal) {
                closeModal();
            }
        }

    </script>
</body>

</html>